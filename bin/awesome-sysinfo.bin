#!/bin/bash

colorscheme="base16-summercamp"
name_suffixes="ðŸ’€"
namewidth=22 && [[ -z "$name_suffixes" ]] && namewidth=20

term(){
    read -r term < /proc/$PPID/comm
    ps | sed -e "s/^ *\([0-9]*\) .*/\1/g" | \
        while read pid
        do ps -o ppid=$pid | \
            while read ppid
            do
                read -r pname 2>/dev/null < /proc/$ppid/comm 
                case $pname in
                    *sh|su*|screen|login|.*init.*|systemd|python|ruby|tmux.*|launchd*|minifetch)
                        ;;
                    *)
                        [[ -n $pname ]] && printf "$pname\n" && break
                        ;;
                esac
                #cat /proc/$ppid/comm | sed -e "s/.sh,su*,screen,${SHELL/*\/},login,*init*,systemd,python,ruby,tmux*,launchd*//g"
            done
        done
    }


term="$(term | head -1)"

song="$(mpc -f "%artist% + %title%" | head -1)"

shell="$(ps ax | grep $PPID | grep -v -e "grep" | sed -e "s/.* \(.*\)/\1/g" | sed -e "s/.*\/\(.*\)/\1/g")"

wm="$(xprop -root _NET_WM_NAME | \
    sed -e 's/.*"\(.*\)".*/\1/g')"

user="$(whoami) [1m$name_suffixes"

printf "\n\n[33mâ”Žâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“                [34mâ”‡\n"
printf "[33mâ”‡  [0;1m%-${namewidth}s[34mâ”ƒ               â”£â”»  â”‡\n" "$user"
printf "[33mâ”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[34mâ”‰â”‰            [34mâ”£â”â”â”‰â”›\n"
printf "[33mâ•‹â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‹â”\n"
printf "[33mâ”ƒ [1;31mï’‰  %-28s  [33mâ”‡\n" "$term"
printf "[33mâ”‡ [1;32mïƒ  %-28s  [33mâ”‡\n" "$shell"
printf "[33mâ”ƒ [0;34mï‹  [1m%-28s  [33mâ”ƒ\n" "$wm"
printf "[33mâ”ƒ [1;35mï¢†  %-28s  [33mâ”ƒ\n" "$song"
printf "[33mâ•‹â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”â”â”â”[34mâ”‰â”‰â•‹â”“\n"
printf "[33mâ”‡ [31mâ–‘[42mâ–ˆâ–‘[32;43mâ–ˆâ–‘[33;44mâ–ˆâ–‘[34;45mâ–ˆâ–‘[35;46mâ–ˆâ–‘[36;47mâ–ˆâ–‘[0;37mâ–ˆâ–‘  [36m ï € %-21s [34mâ”‡\n" $colorscheme
printf "[34mâ”‡[33mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«\n"
printf "[34mâ”—\n[0m"



